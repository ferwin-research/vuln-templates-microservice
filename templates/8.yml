vulnerability:
  name:
    pt-br: Validação de integridade do arquivo de log está desativada
    en: Log file integrity validation is disabled
    es: La validación de integridad del archivo de registro está deshabilitada
  type: cloud
  category: Other
  description:
    pt-br: |
      O CloudTrail é um recurso importante nas contas AWS, isso se dá ao fato que ele registra todos os eventos na API da AWS e permite auditorias e também investigações em casos de incidentes. Mas foi possível notar que na lista “wazuh-trail” o recurso “LogFileValidationEnabled” está desativado. O recurso "LogFileValidationEnabled" (Habilitar validação de integridade de arquivos de log) no AWS CloudTrail se refere a uma opção que permite a validação da integridade dos arquivos de log gerados pelo CloudTrail. Quando ativado, esse recurso verifica a integridade dos arquivos de log para garantir que eles não tenham sido modificados ou corrompidos após a sua criação. Isso ajuda a manter a integridade e a confiabilidade dos registros de auditoria no CloudTrail.
      A validação de integridade dos arquivos de log é uma prática importante para fins de segurança e conformidade, pois garante que os registros de auditoria não tenham sido adulterados ou manipulados por terceiros maliciosos ou acidentalmente devido a falhas de armazenamento ou transferência. Quando você habilita a validação de integridade de arquivos de log, o CloudTrail usará algoritmos de hash para calcular resumos (hashes) dos arquivos de log e, em seguida, comparará esses hashes com os valores esperados. Se houver qualquer discrepância ou sinal de que um arquivo de log foi alterado, isso será detectado e registrado.
      Ativar a validação de integridade de arquivos de log é uma prática recomendada para garantir a confiabilidade dos registros de auditoria no ambiente da AWS. No entanto, lembre-se de que essa função pode consumir recursos adicionais, como tempo de CPU, durante a geração e a verificação dos hashes, portanto, avalie os requisitos e impactos específicos para sua conta e aplicação antes de ativá-la.  Sem essa opção ativa, as chances podem aumentar drasticamente de um defeito afetar a integridade dos logs e o problema só ser descoberto quando uma real necessidade aparecer para que o log seja usado. Correndo o risco de que não seja possível fazer essa utilização.
    en: |
      CloudTrail is an important feature in AWS accounts, as it records all events in the AWS API and allows audits and investigations in case of incidents. But it was possible to notice that in the "wazuh-trail" list the "LogFileValidationEnabled" feature is disabled. The "LogFileValidationEnabled" feature in AWS CloudTrail refers to an option that allows the validation of the integrity of the log files generated by CloudTrail. When enabled, this feature checks the integrity of the log files to ensure that they have not been modified or corrupted after their creation. This helps maintain the integrity and reliability of audit logs in CloudTrail.
      Log file integrity validation is an important practice for security and compliance purposes, as it ensures that audit logs have not been tampered with or manipulated by malicious third parties or accidentally due to storage or transfer failures. When you enable log file integrity validation, CloudTrail will use hash algorithms to calculate digests (hashes) of the log files and then compare these hashes with the expected values. If there is any discrepancy or sign that a log file has been altered, this will be detected and recorded.
      Enabling log file integrity validation is a recommended practice to ensure the reliability of audit logs in the AWS environment. However, keep in mind that this feature can consume additional resources, such as CPU time, during the generation and verification of hashes, so evaluate the specific requirements and impacts for your account and application before enabling it. Without this option active, the chances can dramatically increase that a defect will affect the integrity of the logs and the problem will only be discovered when a real need arises for the log to be used. Running the risk that it may not be possible to make this use.
    es: 
  recommendation:
    pt-br: |
      Para ativar essa opção pode ser utilizado o comando:
      $ aws cloudtrail update-trail --name your-trail-name --enable-log-file-validation
    en: |
      To enable this option, the command can be used:
      $ aws cloudtrail update-trail --name your-trail-name --enable-log-file-validation
    es:
  references:
    - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html