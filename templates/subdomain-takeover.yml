vulnerability:
  name:
    pt-br: Subdomain Takeover
    en: Subdomain Takeover
    es: Subdomain Takeover
  type: network
  category: Misconfig
  description:
    pt-br: "Este tipo de vulnerabilidade acontece quando um subdomínio está configurado para redirecionar o tráfego para um serviço ou hospedagem compartilhada, para a realização dessa configuração comumente utiliza-se uma entrada DNS CNAME. Caso esse subdomínio caia em desuso, tornando-o obsoleto, o proprietário cessa sua inscrição no serviço de hospedagem sem alterar a configuração do servidor DNS. Com isso, o endereço fica disponível para reutilização e acessível através de um subdomínio da vítima. De forma exemplificada, este ataque acontece da seguinte maneira: você registra um serviço específico em uma certa plataforma que provê recursos compartilhados, como por exemplo shared-storage.mycloud.com. Depois disso, seu subdomínio \"testlab\" recebe uma nova entrada de DNS que aponta para um registro CNAME para: shared-storage.mycloud.com e o mesmo passa a funcionar perfeitamente. O tempo passa, e um ano depois, você não precisa mais desse serviço compartilhado de storage, chamado de testlab.company.com e cancela o registro, mas esquece de remover a entrada DNS de testlab.company.com que tem como endereço shared-storage.mycloud.com. Assim nasce o problema, pois agora, alguém pode acessar essa mesma empresa de serviço de storage e criar/configurar o shared-storage.mycloud.com e ter um apontamento válido no domínio em questão. Possuindo controle sobre o subdomínio sequestrado, o atacante ganha confiabilidade em ataques de phishing, payloads de Cross-Site Scripting, distribuição de malware, etc. Conseguimos obter controle total do subdomínio, onde podemos modificar o código fonte da aplicação para: explorar cenários de XSS, distribuir malwares, distribuir campanhas de phishing. Colocando em risco toda a camada da privacidade, integridade e confidencialidade dos usuários e colaboradores e usuários."
    en: "This type of vulnerability occurs when a subdomain is configured to redirect traffic to a shared service or hosting, for this configuration is commonly used a DNS CNAME entry. If this subdomain falls into disuse, making it obsolete, the owner ceases to subscribe to the hosting service without changing the DNS server configuration. With this, the address becomes available for reuse and accessible through a victim's subdomain. In an exemplified way, this attack happens as follows: you register a specific service on a certain platform that provides shared resources, such as shared-storage.mycloud.com. After that, your subdomain \"testlab\" receives a new DNS entry that points to a CNAME record for: shared-storage.mycloud.com and it starts working perfectly. Time passes, and a year later, you no longer need this shared storage service, called testlab.company.com and cancels the registration, but forgets to remove the DNS entry of testlab.company.com that has shared-storage.mycloud.com as the address. Thus the problem arises, because now, someone can access this same storage service company and create / configure shared-storage.mycloud.com and have a valid pointing in the domain in question. Having control over the hijacked subdomain, the attacker gains reliability in phishing attacks, Cross-Site Scripting payloads, malware distribution, etc. We can gain full control of the subdomain, where we can modify the application's source code to: exploit XSS scenarios, distribute malware, distribute phishing campaigns. Putting at risk the entire layer of privacy, integrity and confidentiality of users and employees."
    es: "Este tipo de vulnerabilidad ocurre cuando un subdominio está configurado para redirigir el tráfico a un servicio o alojamiento compartido, para esta configuración se utiliza comúnmente una entrada DNS CNAME. Si este subdominio cae en desuso, volviéndolo obsoleto, el propietario deja de suscribirse al servicio de alojamiento sin cambiar la configuración del servidor DNS. Con esto, la dirección se vuelve disponible para su reutilización y accesible a través de un subdominio de la víctima. De una manera ejemplificada, este ataque sucede de la siguiente manera: usted registra un servicio específico en una cierta plataforma que proporciona recursos compartidos, como por ejemplo shared-storage.mycloud.com. Después de eso, su subdominio \"testlab\" recibe una nueva entrada de DNS que apunta a un registro CNAME para: shared-storage.mycloud.com y comienza a funcionar perfectamente. El tiempo pasa, y un año después, ya no necesita este servicio de almacenamiento compartido, llamado testlab.company.com y cancela el registro, pero olvida eliminar la entrada DNS de testlab.company.com que tiene shared-storage.mycloud.com como dirección. Así surge el problema, porque ahora, alguien puede acceder a esta misma empresa de servicios de almacenamiento y crear / configurar shared-storage.mycloud.com y tener un apuntamiento válido en el dominio en cuestión. Teniendo control sobre el subdominio secuestrado, el atacante gana confiabilidad en ataques de phishing, cargas útiles de Cross-Site Scripting, distribución de malware, etc. Podemos obtener control total del subdominio, donde podemos modificar el código fuente de la aplicación para: explotar escenarios de XSS, distribuir malware, distribuir campañas de phishing. Poniendo en riesgo toda la capa de privacidad, integridad y confidencialidad de los usuarios y empleados."
  recommendation:
    pt-br: Deve ser removido o registro DNS de entrada já que o mesmo não tem nenhuma utilização no momento.
    en: The DNS entry record should be removed since it has no use at the moment.
    es: El registro de entrada DNS debe ser eliminado ya que no tiene uso en este momento.
  references:
    - https://developer.mozilla.org/en-US/docs/Web/Security/Subdomain_takeovers
    - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover